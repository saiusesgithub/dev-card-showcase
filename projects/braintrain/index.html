<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ðŸ§  Brain Training Gym</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Roboto+Mono:wght@400;500&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .container {
            width: 100%;
            max-width: 900px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 24px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            overflow: hidden;
            position: relative;
        }

        /* Header */
        .header {
            background: linear-gradient(135deg, #4f46e5, #7c3aed);
            color: white;
            padding: 30px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.05'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
        }

        .header-content {
            position: relative;
            z-index: 1;
        }

        h1 {
            font-size: 2.8rem;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }

        .subtitle {
            font-size: 1.1rem;
            opacity: 0.9;
            margin-bottom: 20px;
        }

        /* Navigation */
        .nav-tabs {
            display: flex;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 5px;
            margin: 0 auto;
            max-width: 600px;
            backdrop-filter: blur(10px);
        }

        .tab-btn {
            flex: 1;
            padding: 14px;
            background: transparent;
            border: none;
            color: white;
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            border-radius: 10px;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .tab-btn:hover {
            background: rgba(255, 255, 255, 0.15);
        }

        .tab-btn.active {
            background: white;
            color: #4f46e5;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }

        /* Main Content */
        .main-content {
            padding: 40px;
            min-height: 500px;
        }

        .game-container {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .game-container.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Common Game Elements */
        .game-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .game-title {
            font-size: 2rem;
            color: #4f46e5;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .game-description {
            color: #666;
            max-width: 600px;
            margin: 0 auto;
            line-height: 1.6;
        }

        .score-display {
            background: linear-gradient(135deg, #f0f4ff, #e6e9ff);
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 30px;
            display: flex;
            justify-content: space-around;
            align-items: center;
            box-shadow: 0 8px 24px rgba(79, 70, 229, 0.1);
        }

        .score-item {
            text-align: center;
        }

        .score-label {
            font-size: 0.9rem;
            color: #666;
            margin-bottom: 5px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
        }

        .score-value {
            font-size: 2rem;
            font-weight: 700;
            color: #4f46e5;
            font-family: 'Roboto Mono', monospace;
        }

        .game-area {
            background: #f8fafc;
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 30px;
            border: 2px solid #e2e8f0;
            min-height: 300px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .control-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
        }

        .btn {
            padding: 16px 32px;
            border: none;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
            min-width: 160px;
            justify-content: center;
        }

        .btn-primary {
            background: linear-gradient(135deg, #4f46e5, #7c3aed);
            color: white;
            box-shadow: 0 8px 20px rgba(79, 70, 229, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 25px rgba(79, 70, 229, 0.4);
        }

        .btn-secondary {
            background: #f1f5f9;
            color: #475569;
            border: 2px solid #cbd5e1;
        }

        .btn-secondary:hover {
            background: #e2e8f0;
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none !important;
        }

        /* Math Game Styles */
        .math-problem {
            font-size: 4rem;
            font-weight: 700;
            color: #1e293b;
            margin-bottom: 30px;
            font-family: 'Roboto Mono', monospace;
            text-align: center;
            min-height: 80px;
        }

        .math-options {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            width: 100%;
            max-width: 500px;
        }

        .math-option {
            padding: 20px;
            background: white;
            border: 2px solid #e2e8f0;
            border-radius: 16px;
            font-size: 1.8rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            font-family: 'Roboto Mono', monospace;
        }

        .math-option:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
            border-color: #4f46e5;
        }

        .math-option.correct {
            background: #10b981;
            color: white;
            border-color: #10b981;
            animation: pulse 0.5s ease;
        }

        .math-option.incorrect {
            background: #ef4444;
            color: white;
            border-color: #ef4444;
            animation: shake 0.5s ease;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }

        .timer-bar {
            width: 100%;
            height: 8px;
            background: #e2e8f0;
            border-radius: 4px;
            margin-top: 20px;
            overflow: hidden;
        }

        .timer-fill {
            height: 100%;
            background: linear-gradient(90deg, #4f46e5, #7c3aed);
            width: 100%;
            transition: width 0.1s linear;
        }

        /* Memory Game Styles */
        .memory-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            width: 100%;
            max-width: 500px;
            margin: 0 auto;
        }

        .memory-card {
            aspect-ratio: 1;
            background: linear-gradient(135deg, #4f46e5, #7c3aed);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transform-style: preserve-3d;
            transition: transform 0.6s;
            position: relative;
            font-size: 2rem;
            color: white;
            user-select: none;
        }

        .memory-card.flipped {
            transform: rotateY(180deg);
        }

        .memory-card.matched {
            background: linear-gradient(135deg, #10b981, #34d399);
            cursor: default;
        }

        .memory-card .front,
        .memory-card .back {
            position: absolute;
            width: 100%;
            height: 100%;
            backface-visibility: hidden;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .memory-card .front {
            background: linear-gradient(135deg, #f1f5f9, #e2e8f0);
            transform: rotateY(180deg);
            color: #1e293b;
        }

        .memory-card .back {
            background: linear-gradient(135deg, #4f46e5, #7c3aed);
        }

        /* Reaction Game Styles */
        .reaction-target {
            width: 150px;
            height: 150px;
            background: linear-gradient(135deg, #4f46e5, #7c3aed);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.5rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 12px 30px rgba(79, 70, 229, 0.3);
            user-select: none;
            position: relative;
            overflow: hidden;
        }

        .reaction-target::before {
            content: '';
            position: absolute;
            top: -10px;
            left: -10px;
            right: -10px;
            bottom: -10px;
            background: linear-gradient(135deg, #4f46e5, #7c3aed);
            border-radius: 50%;
            opacity: 0.3;
            animation: pulseRing 2s infinite;
        }

        .reaction-target.waiting {
            background: linear-gradient(135deg, #f59e0b, #fbbf24);
        }

        .reaction-target.waiting::before {
            background: linear-gradient(135deg, #f59e0b, #fbbf24);
        }

        .reaction-target:hover:not(.waiting) {
            transform: scale(1.05);
        }

        .reaction-target:active:not(.waiting) {
            transform: scale(0.95);
        }

        .reaction-result {
            font-size: 1.8rem;
            font-weight: 600;
            color: #10b981;
            margin-top: 20px;
            text-align: center;
            min-height: 40px;
            font-family: 'Roboto Mono', monospace;
        }

        .reaction-result.slow {
            color: #ef4444;
        }

        .reaction-history {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .reaction-time {
            background: #f1f5f9;
            padding: 8px 16px;
            border-radius: 20px;
            font-family: 'Roboto Mono', monospace;
            font-size: 0.9rem;
            color: #475569;
        }

        .reaction-time.fast {
            background: #d1fae5;
            color: #065f46;
        }

        .reaction-time.slow {
            background: #fee2e2;
            color: #991b1b;
        }

        @keyframes pulseRing {
            0% { transform: scale(0.8); opacity: 0.3; }
            50% { transform: scale(1.1); opacity: 0.1; }
            100% { transform: scale(0.8); opacity: 0.3; }
        }

        /* Results Screen */
        .results-screen {
            text-align: center;
            animation: slideIn 0.5s ease;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .results-title {
            font-size: 2.5rem;
            color: #4f46e5;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
        }

        .results-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin: 30px 0;
        }

        .result-item {
            background: white;
            border-radius: 16px;
            padding: 25px;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.08);
            border: 2px solid #e2e8f0;
        }

        .result-icon {
            font-size: 2.5rem;
            color: #4f46e5;
            margin-bottom: 15px;
        }

        .result-label {
            font-size: 0.9rem;
            color: #666;
            margin-bottom: 10px;
        }

        .result-value {
            font-size: 2.2rem;
            font-weight: 700;
            color: #1e293b;
            font-family: 'Roboto Mono', monospace;
        }

        .performance-rating {
            font-size: 1.2rem;
            color: #4f46e5;
            margin-top: 30px;
            padding: 15px 30px;
            background: #f0f4ff;
            border-radius: 50px;
            display: inline-block;
        }

        /* Footer */
        .footer {
            padding: 20px;
            text-align: center;
            color: #666;
            font-size: 0.9rem;
            border-top: 1px solid #e2e8f0;
            background: #f8fafc;
        }

        .footer-links {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-top: 10px;
        }

        .footer-links a {
            color: #4f46e5;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .footer-links a:hover {
            text-decoration: underline;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .container {
                border-radius: 20px;
            }
            
            h1 {
                font-size: 2.2rem;
            }
            
            .main-content {
                padding: 25px;
            }
            
            .math-options {
                grid-template-columns: 1fr;
            }
            
            .memory-grid {
                grid-template-columns: repeat(3, 1fr);
            }
            
            .results-stats {
                grid-template-columns: 1fr;
            }
            
            .score-display {
                flex-direction: column;
                gap: 20px;
            }
            
            .control-buttons {
                flex-direction: column;
            }
            
            .btn {
                width: 100%;
            }
        }

        @media (max-width: 480px) {
            .header {
                padding: 20px;
            }
            
            h1 {
                font-size: 1.8rem;
            }
            
            .nav-tabs {
                flex-direction: column;
            }
            
            .game-title {
                font-size: 1.6rem;
            }
            
            .math-problem {
                font-size: 3rem;
            }
            
            .memory-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="header-content">
                <h1>
                    <i class="fas fa-brain"></i>
                    Brain Training Gym
                </h1>
                <p class="subtitle">Challenge your mind with these cognitive exercises</p>
                
                <div class="nav-tabs">
                    <button class="tab-btn active" data-tab="math">
                        <i class="fas fa-calculator"></i>
                        Math Speed
                    </button>
                    <button class="tab-btn" data-tab="memory">
                        <i class="fas fa-memory"></i>
                        Memory Test
                    </button>
                    <button class="tab-btn" data-tab="reaction">
                        <i class="fas fa-bolt"></i>
                        Reaction Time
                    </button>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Math Game -->
            <div class="game-container active" id="mathGame">
                <div class="game-header">
                    <h2 class="game-title">
                        <i class="fas fa-calculator"></i>
                        Math Speed Test
                    </h2>
                    <p class="game-description">
                        Solve as many math problems as you can in 60 seconds. Choose the correct answer from the options below.
                    </p>
                </div>

                <div class="score-display">
                    <div class="score-item">
                        <div class="score-label">
                            <i class="fas fa-clock"></i> Time Left
                        </div>
                        <div class="score-value" id="mathTime">60</div>
                    </div>
                    <div class="score-item">
                        <div class="score-label">
                            <i class="fas fa-check-circle"></i> Score
                        </div>
                        <div class="score-value" id="mathScore">0</div>
                    </div>
                    <div class="score-item">
                        <div class="score-label">
                            <i class="fas fa-bolt"></i> High Score
                        </div>
                        <div class="score-value" id="mathHighScore">0</div>
                    </div>
                </div>

                <div class="game-area">
                    <div class="math-problem" id="mathProblem">5 + 3 = ?</div>
                    
                    <div class="math-options" id="mathOptions">
                        <!-- Options will be generated by JavaScript -->
                    </div>
                    
                    <div class="timer-bar">
                        <div class="timer-fill" id="mathTimerBar"></div>
                    </div>
                </div>

                <div class="control-buttons">
                    <button class="btn btn-primary" id="mathStartBtn">
                        <i class="fas fa-play"></i> Start Game
                    </button>
                    <button class="btn btn-secondary" id="mathResetBtn">
                        <i class="fas fa-redo"></i> Reset
                    </button>
                </div>
            </div>

            <!-- Memory Game -->
            <div class="game-container" id="memoryGame">
                <div class="game-header">
                    <h2 class="game-title">
                        <i class="fas fa-memory"></i>
                        Memory Test
                    </h2>
                    <p class="game-description">
                        Memorize the pattern of cards, then find all matching pairs. Try to complete the game in the fewest moves possible.
                    </p>
                </div>

                <div class="score-display">
                    <div class="score-item">
                        <div class="score-label">
                            <i class="fas fa-arrows-alt-h"></i> Moves
                        </div>
                        <div class="score-value" id="memoryMoves">0</div>
                    </div>
                    <div class="score-item">
                        <div class="score-label">
                            <i class="fas fa-check-double"></i> Matches
                        </div>
                        <div class="score-value" id="memoryMatches">0/8</div>
                    </div>
                    <div class="score-item">
                        <div class="score-label">
                            <i class="fas fa-trophy"></i> Best Score
                        </div>
                        <div class="score-value" id="memoryBestScore">-</div>
                    </div>
                </div>

                <div class="game-area">
                    <div class="memory-grid" id="memoryGrid">
                        <!-- Cards will be generated by JavaScript -->
                    </div>
                </div>

                <div class="control-buttons">
                    <button class="btn btn-primary" id="memoryStartBtn">
                        <i class="fas fa-play"></i> Start Game
                    </button>
                    <button class="btn btn-secondary" id="memoryResetBtn">
                        <i class="fas fa-eye"></i> Show All
                    </button>
                </div>
            </div>

            <!-- Reaction Game -->
            <div class="game-container" id="reactionGame">
                <div class="game-header">
                    <h2 class="game-title">
                        <i class="fas fa-bolt"></i>
                        Reaction Time Test
                    </h2>
                    <p class="game-description">
                        Click the circle as soon as it turns green. Your reaction time will be measured in milliseconds.
                    </p>
                </div>

                <div class="score-display">
                    <div class="score-item">
                        <div class="score-label">
                            <i class="fas fa-stopwatch"></i> Current
                        </div>
                        <div class="score-value" id="reactionCurrent">-</div>
                    </div>
                    <div class="score-item">
                        <div class="score-label">
                            <i class="fas fa-chart-line"></i> Average
                        </div>
                        <div class="score-value" id="reactionAverage">-</div>
                    </div>
                    <div class="score-item">
                        <div class="score-label">
                            <i class="fas fa-crown"></i> Best
                        </div>
                        <div class="score-value" id="reactionBest">-</div>
                    </div>
                </div>

                <div class="game-area">
                    <div class="reaction-target" id="reactionTarget">
                        Wait for green...
                    </div>
                    
                    <div class="reaction-result" id="reactionResult"></div>
                    
                    <div class="reaction-history" id="reactionHistory">
                        <!-- Reaction times will be added here -->
                    </div>
                </div>

                <div class="control-buttons">
                    <button class="btn btn-primary" id="reactionStartBtn">
                        <i class="fas fa-play"></i> Start Test
                    </button>
                    <button class="btn btn-secondary" id="reactionResetBtn">
                        <i class="fas fa-history"></i> Clear History
                    </button>
                </div>
            </div>
        </main>

        <!-- Footer -->
        <footer class="footer">
            <p>ðŸ§  Brain Training Gym â€¢ Challenge yourself daily!</p>
            <div class="footer-links">
                <a href="#" id="showResults">
                    <i class="fas fa-chart-bar"></i> View Stats
                </a>
                <a href="#" id="resetAll">
                    <i class="fas fa-trash-alt"></i> Clear All Data
                </a>
                <a href="#" id="helpBtn">
                    <i class="fas fa-question-circle"></i> Help
                </a>
            </div>
        </footer>
    </div>

    <script>
        // Brain Training App
        class BrainTrainingApp {
            constructor() {
                // Game state
                this.currentGame = 'math';
                this.gameStates = {
                    math: {
                        active: false,
                        score: 0,
                        timeLeft: 60,
                        timer: null,
                        highScore: parseInt(localStorage.getItem('mathHighScore')) || 0,
                        problem: null
                    },
                    memory: {
                        active: false,
                        moves: 0,
                        matches: 0,
                        totalPairs: 8,
                        flippedCards: [],
                        matchedCards: [],
                        canFlip: true,
                        bestScore: localStorage.getItem('memoryBestScore') || '-',
                        cards: []
                    },
                    reaction: {
                        active: false,
                        startTime: null,
                        reactionTimes: JSON.parse(localStorage.getItem('reactionTimes')) || [],
                        currentReaction: null,
                        waiting: false
                    }
                };

                this.init();
            }

            init() {
                this.setupEventListeners();
                this.updateHighScores();
                this.setupMemoryCards();
            }

            setupEventListeners() {
                // Tab navigation
                document.querySelectorAll('.tab-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const tab = e.currentTarget.dataset.tab;
                        this.switchGame(tab);
                    });
                });

                // Math game
                document.getElementById('mathStartBtn').addEventListener('click', () => this.startMathGame());
                document.getElementById('mathResetBtn').addEventListener('click', () => this.resetMathGame());

                // Memory game
                document.getElementById('memoryStartBtn').addEventListener('click', () => this.startMemoryGame());
                document.getElementById('memoryResetBtn').addEventListener('click', () => this.showAllCards());

                // Reaction game
                document.getElementById('reactionStartBtn').addEventListener('click', () => this.startReactionTest());
                document.getElementById('reactionResetBtn').addEventListener('click', () => this.clearReactionHistory());
                document.getElementById('reactionTarget').addEventListener('click', () => this.handleReactionClick());

                // Footer buttons
                document.getElementById('showResults').addEventListener('click', (e) => {
                    e.preventDefault();
                    this.showResults();
                });

                document.getElementById('resetAll').addEventListener('click', (e) => {
                    e.preventDefault();
                    this.resetAllData();
                });

                document.getElementById('helpBtn').addEventListener('click', (e) => {
                    e.preventDefault();
                    this.showHelp();
                });
            }

            // Game Switching
            switchGame(game) {
                // Update active tab
                document.querySelectorAll('.tab-btn').forEach(btn => {
                    btn.classList.remove('active');
                    if (btn.dataset.tab === game) {
                        btn.classList.add('active');
                    }
                });

                // Update active game container
                document.querySelectorAll('.game-container').forEach(container => {
                    container.classList.remove('active');
                });
                document.getElementById(`${game}Game`).classList.add('active');

                this.currentGame = game;

                // Stop any running games
                this.stopMathGame();
                this.hideAllCards();
            }

            // ===== MATH GAME =====
            startMathGame() {
                const state = this.gameStates.math;
                
                if (state.active) return;
                
                state.active = true;
                state.score = 0;
                state.timeLeft = 60;
                
                // Update UI
                document.getElementById('mathStartBtn').disabled = true;
                document.getElementById('mathScore').textContent = '0';
                document.getElementById('mathTime').textContent = '60';
                document.getElementById('mathTimerBar').style.width = '100%';
                
                // Start timer
                this.startMathTimer();
                
                // Generate first problem
                this.generateMathProblem();
            }

            startMathTimer() {
                const state = this.gameStates.math;
                const timerBar = document.getElementById('mathTimerBar');
                
                state.timer = setInterval(() => {
                    state.timeLeft--;
                    
                    // Update display
                    document.getElementById('mathTime').textContent = state.timeLeft;
                    timerBar.style.width = `${(state.timeLeft / 60) * 100}%`;
                    
                    // Time's up
                    if (state.timeLeft <= 0) {
                        this.endMathGame();
                    }
                }, 1000);
            }

            generateMathProblem() {
                const state = this.gameStates.math;
                
                // Generate random numbers and operation
                const operations = ['+', '-', 'Ã—', 'Ã·'];
                const operation = operations[Math.floor(Math.random() * operations.length)];
                
                let num1, num2, correctAnswer;
                
                switch(operation) {
                    case '+':
                        num1 = Math.floor(Math.random() * 50) + 1;
                        num2 = Math.floor(Math.random() * 50) + 1;
                        correctAnswer = num1 + num2;
                        break;
                    case '-':
                        num1 = Math.floor(Math.random() * 50) + 1;
                        num2 = Math.floor(Math.random() * num1) + 1;
                        correctAnswer = num1 - num2;
                        break;
                    case 'Ã—':
                        num1 = Math.floor(Math.random() * 12) + 1;
                        num2 = Math.floor(Math.random() * 12) + 1;
                        correctAnswer = num1 * num2;
                        break;
                    case 'Ã·':
                        num2 = Math.floor(Math.random() * 10) + 2;
                        correctAnswer = Math.floor(Math.random() * 10) + 2;
                        num1 = num2 * correctAnswer;
                        break;
                }
                
                // Generate wrong answers
                const answers = new Set([correctAnswer]);
                while (answers.size < 4) {
                    let wrongAnswer;
                    const offset = Math.floor(Math.random() * 10) + 1;
                    const direction = Math.random() > 0.5 ? 1 : -1;
                    wrongAnswer = correctAnswer + (offset * direction);
                    
                    if (wrongAnswer > 0 && wrongAnswer !== correctAnswer) {
                        answers.add(wrongAnswer);
                    }
                }
                
                // Convert to array and shuffle
                const answerArray = Array.from(answers);
                this.shuffleArray(answerArray);
                
                // Store problem
                state.problem = {
                    num1,
                    num2,
                    operation,
                    correctAnswer,
                    answers: answerArray
                };
                
                // Update UI
                const problemDisplay = document.getElementById('mathProblem');
                let displayOperation = operation;
                if (operation === 'Ã—') displayOperation = 'Ã—';
                if (operation === 'Ã·') displayOperation = 'Ã·';
                
                problemDisplay.textContent = `${num1} ${displayOperation} ${num2} = ?`;
                
                // Update answer buttons
                const optionsContainer = document.getElementById('mathOptions');
                optionsContainer.innerHTML = '';
                
                answerArray.forEach((answer, index) => {
                    const button = document.createElement('div');
                    button.className = 'math-option';
                    button.textContent = answer;
                    button.dataset.answer = answer;
                    
                    button.addEventListener('click', () => this.checkMathAnswer(answer));
                    
                    optionsContainer.appendChild(button);
                });
            }

            checkMathAnswer(answer) {
                const state = this.gameStates.math;
                if (!state.active || !state.problem) return;
                
                const isCorrect = answer === state.problem.correctAnswer;
                const buttons = document.querySelectorAll('.math-option');
                
                // Show correct/incorrect feedback
                buttons.forEach(button => {
                    const buttonAnswer = parseInt(button.dataset.answer);
                    
                    if (buttonAnswer === state.problem.correctAnswer) {
                        button.classList.add('correct');
                    } else if (buttonAnswer === answer && !isCorrect) {
                        button.classList.add('incorrect');
                    }
                    
                    button.style.pointerEvents = 'none';
                });
                
                // Update score if correct
                if (isCorrect) {
                    state.score++;
                    document.getElementById('mathScore').textContent = state.score;
                }
                
                // Generate next problem after delay
                setTimeout(() => {
                    if (state.active) {
                        this.generateMathProblem();
                    }
                }, 1000);
            }

            endMathGame() {
                const state = this.gameStates.math;
                
                // Stop timer
                clearInterval(state.timer);
                state.active = false;
                
                // Update high score
                if (state.score > state.highScore) {
                    state.highScore = state.score;
                    localStorage.setItem('mathHighScore', state.highScore);
                    document.getElementById('mathHighScore').textContent = state.highScore;
                }
                
                // Enable start button
                document.getElementById('mathStartBtn').disabled = false;
                
                // Show results
                alert(`Time's up! Your score: ${state.score}\nHigh Score: ${state.highScore}`);
            }

            resetMathGame() {
                const state = this.gameStates.math;
                
                // Stop timer
                clearInterval(state.timer);
                state.active = false;
                
                // Reset state
                state.score = 0;
                state.timeLeft = 60;
                
                // Update UI
                document.getElementById('mathStartBtn').disabled = false;
                document.getElementById('mathScore').textContent = '0';
                document.getElementById('mathTime').textContent = '60';
                document.getElementById('mathTimerBar').style.width = '100%';
                document.getElementById('mathProblem').textContent = 'Ready?';
                
                // Clear options
                document.getElementById('mathOptions').innerHTML = '';
            }

            stopMathGame() {
                const state = this.gameStates.math;
                if (state.timer) {
                    clearInterval(state.timer);
                    state.timer = null;
                }
                state.active = false;
                document.getElementById('mathStartBtn').disabled = false;
            }

            // ===== MEMORY GAME =====
            setupMemoryCards() {
                const state = this.gameStates.memory;
                const symbols = ['â˜…', 'â™¥', 'â™¦', 'â™£', 'â™ ', 'â—', 'â–²', 'â– '];
                const cards = [...symbols, ...symbols]; // Create pairs
                this.shuffleArray(cards);
                
                state.cards = cards.map((symbol, index) => ({
                    id: index,
                    symbol: symbol,
                    flipped: false,
                    matched: false
                }));
                
                this.renderMemoryCards();
            }

            renderMemoryCards() {
                const grid = document.getElementById('memoryGrid');
                grid.innerHTML = '';
                
                this.gameStates.memory.cards.forEach(card => {
                    const cardElement = document.createElement('div');
                    cardElement.className = 'memory-card';
                    cardElement.dataset.id = card.id;
                    
                    cardElement.innerHTML = `
                        <div class="front">${card.symbol}</div>
                        <div class="back"></div>
                    `;
                    
                    cardElement.addEventListener('click', () => this.flipMemoryCard(card.id));
                    
                    if (card.flipped || card.matched) {
                        cardElement.classList.add('flipped');
                    }
                    
                    if (card.matched) {
                        cardElement.classList.add('matched');
                    }
                    
                    grid.appendChild(cardElement);
                });
            }

            startMemoryGame() {
                const state = this.gameStates.memory;
                
                // Reset game state
                state.moves = 0;
                state.matches = 0;
                state.flippedCards = [];
                state.matchedCards = [];
                state.canFlip = true;
                
                // Reset cards
                state.cards.forEach(card => {
                    card.flipped = false;
                    card.matched = false;
                });
                
                // Update UI
                document.getElementById('memoryMoves').textContent = '0';
                document.getElementById('memoryMatches').textContent = '0/8';
                document.getElementById('memoryStartBtn').disabled = true;
                
                // Shuffle cards
                this.shuffleArray(state.cards);
                this.renderMemoryCards();
                
                // Show all cards briefly
                this.showAllCards();
                setTimeout(() => this.hideAllCards(), 2000);
            }

            flipMemoryCard(cardId) {
                const state = this.gameStates.memory;
                
                if (!state.canFlip || state.flippedCards.length >= 2) return;
                
                const card = state.cards.find(c => c.id === cardId);
                if (!card || card.flipped || card.matched) return;
                
                // Flip card
                card.flipped = true;
                state.flippedCards.push(cardId);
                
                // Update UI
                const cardElement = document.querySelector(`.memory-card[data-id="${cardId}"]`);
                cardElement.classList.add('flipped');
                
                // Check for match
                if (state.flippedCards.length === 2) {
                    state.moves++;
                    document.getElementById('memoryMoves').textContent = state.moves;
                    
                    state.canFlip = false;
                    
                    setTimeout(() => this.checkMemoryMatch(), 1000);
                }
            }

            checkMemoryMatch() {
                const state = this.gameStates.memory;
                
                if (state.flippedCards.length !== 2) return;
                
                const [id1, id2] = state.flippedCards;
                const card1 = state.cards.find(c => c.id === id1);
                const card2 = state.cards.find(c => c.id === id2);
                
                if (card1.symbol === card2.symbol) {
                    // Match found
                    card1.matched = true;
                    card2.matched = true;
                    state.matches++;
                    state.matchedCards.push(id1, id2);
                    
                    // Update UI
                    document.getElementById('memoryMatches').textContent = `${state.matches}/8`;
                    
                    // Check for game completion
                    if (state.matches === state.totalPairs) {
                        this.endMemoryGame();
                    }
                } else {
                    // No match, flip cards back
                    card1.flipped = false;
                    card2.flipped = false;
                    
                    const cardElement1 = document.querySelector(`.memory-card[data-id="${id1}"]`);
                    const cardElement2 = document.querySelector(`.memory-card[data-id="${id2}"]`);
                    
                    cardElement1.classList.remove('flipped');
                    cardElement2.classList.remove('flipped');
                }
                
                // Reset for next turn
                state.flippedCards = [];
                state.canFlip = true;
            }

            showAllCards() {
                const state = this.gameStates.memory;
                
                state.cards.forEach(card => {
                    card.flipped = true;
                });
                
                this.renderMemoryCards();
                
                setTimeout(() => {
                    if (!state.active) return;
                    state.cards.forEach(card => {
                        if (!card.matched) {
                            card.flipped = false;
                        }
                    });
                    this.renderMemoryCards();
                }, 2000);
            }

            hideAllCards() {
                const state = this.gameStates.memory;
                
                state.cards.forEach(card => {
                    if (!card.matched) {
                        card.flipped = false;
                    }
                });
                
                this.renderMemoryCards();
                document.getElementById('memoryStartBtn').disabled = false;
            }

            endMemoryGame() {
                const state = this.gameStates.memory;
                
                // Update best score
                const currentBest = state.bestScore === '-' ? Infinity : parseInt(state.bestScore);
                
                if (state.moves < currentBest) {
                    state.bestScore = state.moves.toString();
                    localStorage.setItem('memoryBestScore', state.bestScore);
                    document.getElementById('memoryBestScore').textContent = state.bestScore;
                }
                
                // Show completion message
                setTimeout(() => {
                    alert(`ðŸŽ‰ Congratulations!\nYou completed the memory game in ${state.moves} moves!\nBest Score: ${state.bestScore}`);
                    document.getElementById('memoryStartBtn').disabled = false;
                }, 500);
            }

            // ===== REACTION GAME =====
            startReactionTest() {
                const state = this.gameStates.reaction;
                
                if (state.waiting) return;
                
                // Reset current reaction
                state.currentReaction = null;
                state.startTime = null;
                
                // Update UI
                const target = document.getElementById('reactionTarget');
                target.classList.add('waiting');
                target.textContent = 'Wait for green...';
                document.getElementById('reactionResult').textContent = '';
                
                // Start waiting period (1-4 seconds)
                const waitTime = Math.random() * 3000 + 1000;
                
                state.waiting = true;
                state.startTime = Date.now() + waitTime;
                
                // Change to green after wait
                setTimeout(() => {
                    if (!state.waiting) return;
                    
                    target.classList.remove('waiting');
                    target.textContent = 'CLICK NOW!';
                    state.startTime = Date.now();
                }, waitTime);
                
                // Timeout if no click
                setTimeout(() => {
                    if (state.waiting && state.startTime < Date.now()) {
                        target.classList.add('waiting');
                        target.textContent = 'Too slow!';
                        state.waiting = false;
                        
                        setTimeout(() => {
                            target.textContent = 'Wait for green...';
                        }, 1000);
                    }
                }, 5000);
            }

            handleReactionClick() {
                const state = this.gameStates.reaction;
                
                if (!state.waiting || !state.startTime || state.startTime > Date.now()) {
                    // Clicked too early
                    if (state.waiting) {
                        const target = document.getElementById('reactionTarget');
                        target.classList.add('waiting');
                        target.textContent = 'Too early!';
                        state.waiting = false;
                        
                        setTimeout(() => {
                            target.textContent = 'Wait for green...';
                        }, 1000);
                    }
                    return;
                }
                
                // Calculate reaction time
                const reactionTime = Date.now() - state.startTime;
                state.currentReaction = reactionTime;
                state.reactionTimes.push(reactionTime);
                
                // Store in localStorage
                localStorage.setItem('reactionTimes', JSON.stringify(state.reactionTimes));
                
                // Update UI
                const result = document.getElementById('reactionResult');
                result.textContent = `${reactionTime} ms`;
                
                if (reactionTime < 200) {
                    result.className = 'reaction-result';
                    result.textContent += ' âš¡ Super Fast!';
                } else if (reactionTime < 300) {
                    result.className = 'reaction-result';
                    result.textContent += ' ðŸŽï¸ Fast!';
                } else if (reactionTime < 500) {
                    result.className = 'reaction-result';
                    result.textContent += ' ðŸ‘ Good';
                } else {
                    result.className = 'reaction-result slow';
                    result.textContent += ' ðŸ¢ Slow';
                }
                
                // Update stats
                this.updateReactionStats();
                
                // Add to history
                this.addReactionToHistory(reactionTime);
                
                // Reset for next test
                state.waiting = false;
                const target = document.getElementById('reactionTarget');
                target.classList.add('waiting');
                
                setTimeout(() => {
                    target.textContent = 'Wait for green...';
                }, 1000);
            }

            updateReactionStats() {
                const state = this.gameStates.reaction;
                
                if (state.reactionTimes.length === 0) {
                    document.getElementById('reactionCurrent').textContent = '-';
                    document.getElementById('reactionAverage').textContent = '-';
                    document.getElementById('reactionBest').textContent = '-';
                    return;
                }
                
                // Current
                if (state.currentReaction) {
                    document.getElementById('reactionCurrent').textContent = `${state.currentReaction}ms`;
                }
                
                // Average
                const average = Math.round(
                    state.reactionTimes.reduce((a, b) => a + b, 0) / state.reactionTimes.length
                );
                document.getElementById('reactionAverage').textContent = `${average}ms`;
                
                // Best
                const best = Math.min(...state.reactionTimes);
                document.getElementById('reactionBest').textContent = `${best}ms`;
            }

            addReactionToHistory(time) {
                const history = document.getElementById('reactionHistory');
                const timeElement = document.createElement('div');
                
                timeElement.className = 'reaction-time';
                timeElement.textContent = `${time}ms`;
                
                if (time < 250) {
                    timeElement.className += ' fast';
                } else if (time > 450) {
                    timeElement.className += ' slow';
                }
                
                // Add to beginning
                history.insertBefore(timeElement, history.firstChild);
                
                // Limit history to 10 items
                while (history.children.length > 10) {
                    history.removeChild(history.lastChild);
                }
            }

            clearReactionHistory() {
                const state = this.gameStates.reaction;
                
                state.reactionTimes = [];
                state.currentReaction = null;
                localStorage.removeItem('reactionTimes');
                
                // Update UI
                document.getElementById('reactionHistory').innerHTML = '';
                this.updateReactionStats();
                document.getElementById('reactionResult').textContent = '';
                
                const target = document.getElementById('reactionTarget');
                target.classList.add('waiting');
                target.textContent = 'Wait for green...';
            }

            // ===== UTILITY FUNCTIONS =====
            shuffleArray(array) {
                for (let i = array.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [array[i], array[j]] = [array[j], array[i]];
                }
                return array;
            }

            updateHighScores() {
                // Math high score
                document.getElementById('mathHighScore').textContent = this.gameStates.math.highScore;
                
                // Memory best score
                document.getElementById('memoryBestScore').textContent = this.gameStates.memory.bestScore;
                
                // Reaction stats
                this.updateReactionStats();
                
                // Load reaction history
                const reactionTimes = JSON.parse(localStorage.getItem('reactionTimes')) || [];
                reactionTimes.forEach(time => this.addReactionToHistory(time));
            }

            showResults() {
                const mathScore = this.gameStates.math.highScore;
                const memoryScore = this.gameStates.memory.bestScore;
                const reactionTimes = this.gameStates.reaction.reactionTimes;
                
                const avgReaction = reactionTimes.length > 0 
                    ? Math.round(reactionTimes.reduce((a, b) => a + b, 0) / reactionTimes.length)
                    : 0;
                const bestReaction = reactionTimes.length > 0 ? Math.min(...reactionTimes) : 0;
                
                const resultsHTML = `
                    <div class="results-screen">
                        <h2 class="results-title">
                            <i class="fas fa-chart-bar"></i>
                            Your Statistics
                        </h2>
                        
                        <div class="results-stats">
                            <div class="result-item">
                                <div class="result-icon">
                                    <i class="fas fa-calculator"></i>
                                </div>
                                <div class="result-label">Math High Score</div>
                                <div class="result-value">${mathScore}</div>
                            </div>
                            
                            <div class="result-item">
                                <div class="result-icon">
                                    <i class="fas fa-memory"></i>
                                </div>
                                <div class="result-label">Memory Best Moves</div>
                                <div class="result-value">${memoryScore}</div>
                            </div>
                            
                            <div class="result-item">
                                <div class="result-icon">
                                    <i class="fas fa-bolt"></i>
                                </div>
                                <div class="result-label">Avg Reaction Time</div>
                                <div class="result-value">${avgReaction || '-'}ms</div>
                            </div>
                        </div>
                        
                        <div class="performance-rating">
                            ${this.getPerformanceRating(mathScore, memoryScore, avgReaction)}
                        </div>
                    </div>
                `;
                
                // Replace main content with results
                const mainContent = document.querySelector('.main-content');
                mainContent.innerHTML = resultsHTML;
                
                // Add back button
                const backButton = document.createElement('button');
                backButton.className = 'btn btn-primary';
                backButton.style.marginTop = '30px';
                backButton.innerHTML = '<i class="fas fa-arrow-left"></i> Back to Games';
                backButton.onclick = () => location.reload();
                
                mainContent.querySelector('.results-screen').appendChild(backButton);
            }

            getPerformanceRating(mathScore, memoryScore, avgReaction) {
                let rating = '';
                
                if (mathScore > 30 && memoryScore !== '-' && parseInt(memoryScore) < 20 && avgReaction < 300) {
                    rating = 'ðŸ† Elite Brain Power!';
                } else if (mathScore > 20 && avgReaction < 400) {
                    rating = 'â­ Excellent Performance';
                } else if (mathScore > 10) {
                    rating = 'ðŸ‘ Good Performance';
                } else {
                    rating = 'ðŸ’ª Keep Practicing!';
                }
                
                return rating;
            }

            resetAllData() {
                if (confirm('Are you sure you want to clear all game data? This cannot be undone.')) {
                    // Clear localStorage
                    localStorage.removeItem('mathHighScore');
                    localStorage.removeItem('memoryBestScore');
                    localStorage.removeItem('reactionTimes');
                    
                    // Reset game states
                    this.gameStates.math.highScore = 0;
                    this.gameStates.memory.bestScore = '-';
                    this.gameStates.reaction.reactionTimes = [];
                    
                    // Update UI
                    this.updateHighScores();
                    alert('All game data has been cleared!');
                }
            }

            showHelp() {
                const helpText = `
                    ðŸ§  BRAIN TRAINING GYM - HELP ðŸ§ 
                    
                    1. MATH SPEED TEST:
                       â€¢ Solve math problems in 60 seconds
                       â€¢ Choose the correct answer from 4 options
                       â€¢ Score 1 point for each correct answer
                       
                    2. MEMORY TEST:
                       â€¢ Memorize card positions
                       â€¢ Find matching pairs
                       â€¢ Try to complete with fewest moves
                       
                    3. REACTION TIME:
                       â€¢ Click when circle turns green
                       â€¢ Don't click too early!
                       â€¢ Try to beat your best time
                       
                    TIPS:
                    â€¢ Practice daily for best results
                    â€¢ Take breaks between sessions
                    â€¢ Challenge yourself with harder levels
                    
                    Your scores are saved automatically!
                `;
                
                alert(helpText);
            }
        }

        // Initialize the app
        const brainTrainingApp = new BrainTrainingApp();

        // Add keyboard shortcuts
        document.addEventListener('keydown', (e) => {
            // Number keys for math game
            if (e.key >= '1' && e.key <= '4' && brainTrainingApp.currentGame === 'math') {
                const buttons = document.querySelectorAll('.math-option');
                const index = parseInt(e.key) - 1;
                if (buttons[index]) {
                    buttons[index].click();
                }
            }
            
            // Space to start/restart current game
            if (e.code === 'Space') {
                e.preventDefault();
                const currentGame = brainTrainingApp.currentGame;
                
                if (currentGame === 'math') {
                    document.getElementById('mathStartBtn').click();
                } else if (currentGame === 'memory') {
                    document.getElementById('memoryStartBtn').click();
                } else if (currentGame === 'reaction') {
                    document.getElementById('reactionStartBtn').click();
                }
            }
        });

        // Add visual feedback on load
        document.addEventListener('DOMContentLoaded', () => {
            // Animate header
            const header = document.querySelector('.header');
            header.style.animation = 'fadeIn 1s ease';
            
            // Pulse brain icon
            const brainIcon = document.querySelector('.fa-brain');
            setInterval(() => {
                brainIcon.style.transform = 'scale(1.1)';
                setTimeout(() => {
                    brainIcon.style.transform = 'scale(1)';
                }, 500);
            }, 2000);
        });
    </script>
</body>
</html>